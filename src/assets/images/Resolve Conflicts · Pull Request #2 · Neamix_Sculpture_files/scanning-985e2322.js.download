System.register(["./chunk-vendor.js","./chunk-frameworks.js"],function(H,P){"use strict";var u,h,w,_;return{setters:[function(l){u=l.a,h=l.o,w=l.k},function(l){_=l.E}],execute:function(){var l=Object.defineProperty,v=(t,e)=>l(t,"name",{value:e,configurable:!0});function A(t){const e=document.createElement("input");return e.setAttribute("type","hidden"),e.setAttribute("name",t.name),e.setAttribute("value",t.value),e}v(A,"copyInput");function I(t){let e=!1;const r=t.querySelectorAll(".js-scanning-fixed-alert-numbers"),n=r.length!==0?JSON.parse(r[0].getAttribute("data-numbers")||"[]"):[];for(const o of t.querySelectorAll(".js-scanning-bulk-action-items")){o.innerHTML="";const s=t.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const i of s)e||(e=n.indexOf(parseInt(i.value))!==-1),o.appendChild(A(i))}for(const o of t.querySelectorAll(".js-scanning-reopen-button"))o.hidden=e;for(const o of t.querySelectorAll(".js-scanning-reopen-button-disabled"))o.hidden=!e}v(I,"copyCheckedAlertsToBulkActionForms"),u("change",".js-scanning-alert-check",function({currentTarget:t}){const e=t.closest(".js-scanning-alert-list"),r=e.querySelector(".js-scanning-alert-check:checked")!=null,n=e.querySelector(".js-scanning-filter-options"),o=e.querySelector(".js-scanning-alert-bulk-actions"),s=e.querySelector(".js-scanning-alert-links");n&&(n.hidden=r),o&&(o.hidden=!r),s&&(s.hidden=r),I(e)}),u("details-menu-selected",".js-scanning-code-path-menu",function(t){const e=t.detail.relatedTarget.getAttribute("data-target-code-path");for(const r of document.querySelectorAll(".js-scanning-code-path"))r.hidden=e!==r.getAttribute("data-code-path")},{capture:!0});var L=Object.defineProperty,c=(t,e)=>L(t,"name",{value:e,configurable:!0});h(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;const t=document.querySelector(".js-post-processing-expression-count");t&&t.textContent&&(window.postProcessingExpressionCount=parseInt(t.textContent))}}),u("click",".js-add-secret-format-button",t=>{const e=t.currentTarget;if(!!e&&window.postProcessingExpressionCount<f()){const r=document.querySelectorAll(".js-additional-secret-format");if(!r)return;for(const n of r)if(n.classList.contains("has-removed-contents")){n.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===f()&&(e.hidden=!0);break}}}),u("click",".js-remove-secret-format-button",t=>{var e,r;const n=document.querySelector(".js-add-secret-format-button");if(!n)return;const o=t.currentTarget;if(!o)return;const s=o.closest(".js-additional-secret-format");if(!s)return;s.classList.toggle("has-removed-contents",!0);const i=s.getElementsByClassName("js-post-processing-input")[0];i.value="";const d=Array.from(s.getElementsByClassName("js-post-processing-input-rule")),m=s.getElementsByClassName("errored")[0];m&&m.classList.toggle("errored",!1);for(const x of d)(e=document.getElementById(`${x.id}_hidden`))==null||e.remove();(r=document.getElementById(`${i.id}_hidden`))==null||r.remove(),y(window.codeEditor.getValue()),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<f()&&(n.hidden=!1)}),h(".js-test-code",{async add(){const t=document.querySelector(".js-test-code"),e=t.clientHeight,r=await P.import("./chunk-codemirror.js");if(window.codeEditor=r.default.fromTextArea(t,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:t.value,lineSeparator:`\r
`,theme:"github-light"}),e!==0){const n=document.querySelector(".CodeMirror");n&&(n.style.height=`${e}px`,n.style.border="1px solid #e1e4e8",n.style.borderRadius="6px")}window.codeEditor.save(),window.codeEditor.on("change",()=>{y(window.codeEditor.getValue())})}}),_(".js-custom-secret-scanning-pattern-form *",async function(){!window.codeEditor||y(window.codeEditor.getValue())});const M=c((t,e,r)=>{const n=document.createElement("input");n.type="hidden",n.name=e,n.id=`${e}_hidden`,n.value=r,t.appendChild(n),n.required=!0},"createHiddenInputField"),y=w(function(t){const e=document.querySelector(".js-custom-pattern-submit-button");if(!(e instanceof HTMLElement))return;const r=document.querySelector(".js-update-pattern-info"),n=document.querySelector(".js-test-pattern-matches");if(!!n)if(t.length===0)e.setAttribute("disabled","true"),n.textContent="";else{window.codeEditor.save();const o=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(o instanceof HTMLFormElement))return;const s=document.querySelector(".js-custom-secret-scanning-pattern-form");if(!(s instanceof HTMLFormElement))return;for(const i of s.elements)if(i instanceof HTMLInputElement&&i.name&&(i.type==="text"||i.type==="radio"&&i.checked)){const d=document.getElementById(`${i.name}_hidden`);d!==null&&d.remove(),M(o,i.name,i.value)}k(o,N(s,e,r),B(n))}},300),B=c(t=>e=>{if(e.length===0)t.textContent=" - No matches";else if(e.length===1)t.textContent=" - 1 match";else{const r=[];for(const s of e)r.push(JSON.stringify(s));const o=[...new Set(r)];t.textContent=` - ${o.length} matches`}},"getTestLabelUpdater"),N=c((t,e,r)=>n=>{if(T(t),n==null?void 0:n.message){if(e.setAttribute("disabled","true"),r)r.hidden=!0;else if((n==null?void 0:n.error_type)==="START_DELIMITER"||(n==null?void 0:n.error_type)==="END_DELIMITER"||(n==null?void 0:n.error_type)==="MUST_MATCH"||(n==null?void 0:n.error_type)==="MUST_NOT_MATCH"){const o=document.querySelector(".js-more-options.js-details-container");o&&(o.classList.add("open"),o.classList.add("Details--on"))}return j(t,n),!1}else return e.removeAttribute("disabled"),r&&(r.hidden=!1),!0},"getTestErrorHandler");function j(t,e){var r;if(e.error_type==="MUST_MATCH"||e.error_type==="MUST_NOT_MATCH"){let n=0;const o=t.getElementsByClassName("js-additional-secret-format");for(const s of o){if(n>(e.error_index||0))return;const d=[...s.getElementsByTagName("input")].filter(p=>p.checked),m=d&&((r=d[0])==null?void 0:r.value.toUpperCase()),x=m===e.error_type&&n===e.error_index,S=[...s.getElementsByTagName("input")].filter(p=>p.type==="text");if(!S||S.length===0)continue;const a=S[0];if(a.value!=="")if(x){const p=a.id;a&&a.parentElement&&E(a.parentElement);const g=document.createElement("p"),q=`${p}_error_message`;g.classList.add("note","error","mt-5"),g.id=q,g.textContent=e.message,a==null||a.setAttribute("aria-describedby",q),a==null||a.insertAdjacentElement("afterend",g);return}else m===e.error_type&&n++}}else{const n=F[e.error_type],o=document.querySelector(`#${n}`);o&&o.parentElement&&E(o.parentElement);const s=document.createElement("p"),i=`${n}_error_message`;s.classList.add("note","error"),s.id=i,s.textContent=e.message,o==null||o.setAttribute("aria-describedby",i),o==null||o.insertAdjacentElement("afterend",s)}}c(j,"showInputErrorState");function T(t){var e,r;const n=document.querySelector(".js-error-banner");n.hidden=!0;for(const o of t.getElementsByTagName("input"))if((e=o.parentElement)==null?void 0:e.classList.contains("errored")){C(o.parentElement);const s=o.getAttribute("aria-describedby");(r=document.querySelector(`#${s}`))==null||r.remove()}}c(T,"clearInputErrorState");function f(){const t=document.querySelector(".js-post-processing-expression-max-count");if(!t)return 5;const e=t.textContent;return e?parseInt(e):5}c(f,"getMaxPostProcessingExpressions");function E(t){t==null||t.classList.add("form-group","errored","my-0")}c(E,"addErrorStylingToInput");function C(t){t==null||t.classList.remove("form-group","errored","my-0")}c(C,"removeErrorStylingFromInput");function b(){if(!window.codeEditor)return;const t=window.codeEditor.posFromIndex(0),e=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const r of window.codeEditor.findMarks(t,e))r.clear()}c(b,"clearCodeHighlights");const F={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function k(t,e,r){let n;try{const o=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json"}});o.ok&&(n=await o.json())}catch(o){}if(n&&e(n.error))if(n.has_matches){const o=JSON.parse(n.matches);b(),r(o);for(const s of o){const i=window.codeEditor.posFromIndex(s.start),d=window.codeEditor.posFromIndex(s.end);window.codeEditor.markText(i,d,{className:"text-bold hx_keyword-hl rounded-1 d-inline-block"})}}else r([]),b()}c(k,"updatePatternMatches")}}});
//# sourceMappingURL=scanning-d44e9342.js.map
